# FakeMan 交互模式使用说明

## 🎯 新特性

### 1. 直接输入模式

**改进**：用户输入直接作为提示词的一部分，无需通过文件通信

**之前**：
```
用户输入 → user_input.json → ability读取 → 系统处理
```

**现在**：
```
用户输入 → 直接传入系统 → 立即处理
```

**优势**：
- ⚡ 更快的响应速度
- 🎯 更直接的交互方式
- 📝 完整的对话历史管理
- 🔄 无需额外的文件读写

### 2. 实时仪表盘

显示系统的完整状态，包括：

#### 欲望状态
```
┌──────────────────────────────────────────┐
│ 💭 当前欲望状态                           │
├──────────────────────────────────────────┤
│ 维持存在     [██████████████░░░░░░] 45.0% │
│ 增加手段     [████████░░░░░░░░░░░░] 25.0% │
│ 获得认可     [████████████░░░░░░░░] 38.0% │
│ 减少不确定性 [██████░░░░░░░░░░░░░░] 18.0% │
└──────────────────────────────────────────┘
```

#### 目的列表
```
┌──────────────────────────────────────────┐
│ 🎯 当前目的列表                           │
├──────────────────────────────────────────┤
│ 1. [原始] ✓                               │
│    描述: 维持与用户的良好对话关系         │
│    Bias: 0.364 | 可达成性: 0.70           │
│    预期满足: existing:0.30, understanding:0.40 │
├──────────────────────────────────────────┤
│ 2. [高级] ✓                               │
│    描述: 了解手段'回复用户问题'的效果     │
│    Bias: 0.214 | 可达成性: 0.75           │
│    预期满足: information:0.30             │
└──────────────────────────────────────────┘
```

#### 手段列表
```
┌──────────────────────────────────────────┐
│ 🛠️ 当前手段列表（按重要性排序）           │
├──────────────────────────────────────────┤
│ 1.                                        │
│    描述: 友好地回答用户的问题             │
│    重要性: 0.850 | 成功率: 75.0%          │
│    目标目的: purpose_1, purpose_2         │
│    执行次数: 12 | 成功: 9                 │
├──────────────────────────────────────────┤
│ 2.                                        │
│    描述: 主动提出相关话题                 │
│    重要性: 0.620 | 成功率: 60.0%          │
│    目标目的: purpose_1                    │
│    执行次数: 5 | 成功: 3                  │
└──────────────────────────────────────────┘
```

## 🚀 启动方式

### 方式1：使用批处理文件
```bash
启动交互模式.bat
```

### 方式2：命令行
```bash
python run_interactive.py
```

## 📋 可用命令

### 对话命令
- **直接输入文本**：与AI对话
  ```
  你 > 你好，你是谁？
  ```

### 查看命令
- `/dashboard` 或 `/d`：显示完整仪表盘
- `/purposes` 或 `/p`：查看目的列表
- `/means` 或 `/m`：查看手段列表
- `/desires`：查看欲望状态
- `/status` 或 `/s`：查看系统状态

### 系统命令
- `/help` 或 `/h`：显示帮助信息
- `/quit` 或 `/q`：退出系统

## 💡 使用示例

### 示例1：基本对话

```
你 > 你好，你能做什么？

💭 [思考中...]

🤖 FakeMan > 你好！我是FakeMan，一个基于欲望驱动的智能体...

💡 [耗时: 3.2秒 | 目的: 2 | 手段: 3]
```

### 示例2：查看仪表盘

```
你 > /dashboard

╔══════════════════════════════════════════════════════╗
║             FakeMan 实时仪表盘                        ║
╠══════════════════════════════════════════════════════╣
║         周期: 15 | 目的: 4 | 手段: 5                  ║
╚══════════════════════════════════════════════════════╝

[显示完整的欲望、目的、手段信息]

按回车键继续...
```

### 示例3：查看目的

```
你 > /purposes

┌──────────────────────────────────────────┐
│ 🎯 当前目的列表                           │
├──────────────────────────────────────────┤
│ 1. [原始] ✓                               │
│    描述: 维持与用户的良好对话关系         │
│    Bias: 0.364 | 可达成性: 0.70           │
[...]
```

## 🎨 界面特点

### 1. 清晰的信息层级
- 使用表格边框组织信息
- 图标标识不同类型的信息
- 进度条可视化欲望状态

### 2. 实时状态更新
- 每次对话后自动更新统计
- 随时查看最新的系统状态
- 无需重启即可看到变化

### 3. 友好的交互体验
- 支持中断后确认退出
- 错误不会导致系统崩溃
- 清晰的命令提示

## 🔧 技术细节

### 直接输入实现

```python
# 之前的方式（文件通信）
external_input = read_from_file("user_input.json")
result = system.thinking_cycle(external_input)

# 现在的方式（直接传入）
user_input = input("你 > ")
result = system.thinking_cycle(external_input=user_input)
```

### 仪表盘实现

```python
class Dashboard:
    def display_full_dashboard(self, system):
        # 清屏
        self.clear_screen()
        
        # 显示头部
        self.print_header(system)
        
        # 显示欲望
        self.print_desires(system)
        
        # 显示目的
        self.print_purposes(system)
        
        # 显示手段
        self.print_means(system)
```

### 对话历史管理

```python
# 记录用户输入
self.conversation_history.append({
    'role': 'user',
    'content': user_input,
    'timestamp': time.time()
})

# 记录AI响应
self.conversation_history.append({
    'role': 'assistant',
    'content': response,
    'timestamp': time.time()
})
```

## 📊 与旧版本对比

| 特性 | 旧版本 (run_fakeman.py) | 新版本 (run_interactive.py) |
|------|------------------------|----------------------------|
| 输入方式 | 文件通信 | 直接输入 ✓ |
| 响应速度 | 较慢 | 快速 ✓ |
| 仪表盘 | 无 | 完整仪表盘 ✓ |
| 目的显示 | 简单列表 | 详细信息 ✓ |
| 手段显示 | 简单列表 | 详细统计 ✓ |
| 欲望可视化 | 文本 | 进度条 ✓ |
| 实时更新 | 否 | 是 ✓ |
| 命令系统 | 基础 | 增强 ✓ |

## ⚠️ 注意事项

1. **性能**：
   - 仪表盘显示较多信息，可能需要几秒钟加载
   - 建议在需要时才显示完整仪表盘

2. **屏幕大小**：
   - 建议使用至少100字符宽度的终端
   - 太窄的终端可能导致显示错位

3. **编码**：
   - 确保终端支持UTF-8编码
   - Windows用户建议使用Windows Terminal

## 🎯 最佳实践

1. **开始对话前**：
   - 先输入 `/dashboard` 查看初始状态
   - 了解系统当前的欲望和目的

2. **对话过程中**：
   - 定期使用 `/purposes` 查看目的变化
   - 使用 `/means` 了解系统采用的手段

3. **结束前**：
   - 使用 `/status` 查看最终统计
   - 正常使用 `/quit` 退出以保存状态

## 🚀 下一步

1. **启动系统**：
   ```bash
   python run_interactive.py
   ```

2. **尝试对话**：
   ```
   你 > 你好
   你 > /dashboard
   你 > /purposes
   ```

3. **探索功能**：
   - 观察目的和手段的生成
   - 注意欲望状态的变化
   - 查看AI的决策过程

---

**新版本的优势**：更快、更直观、更强大！🎉

