╔══════════════════════════════════════════════════════════════╗
║          FakeMan 两层架构快速参考                             ║
╚══════════════════════════════════════════════════════════════╝

┌──────────────────────────────────────────────────────────────┐
│ 🏗️ 架构概览                                                  │
└──────────────────────────────────────────────────────────────┘

思考层 (Thinking Layer)          执行层 (Execution Layer)
    ↓                                    ↓
 持续运行                            独立进程
 分析决策                            接收命令
 输出：行动【...】                   严格执行
 可见执行历史                        返回结果

         命令传递（JSON）
    ──────────────────────→
         结果返回（JSON）
    ←──────────────────────

┌──────────────────────────────────────────────────────────────┐
│ 📋 命令格式                                                   │
└──────────────────────────────────────────────────────────────┘

【思考层输出格式】
决策: 行动【具体的执行指令】

示例：
✓ 决策: 行动【热情地问候用户并询问需求】
✓ 决策: 行动【分享一个关于编程的有趣知识】
✓ 决策: 行动【执行系统命令: dir】

错误示例：
✗ 决策: 我将采用组合策略...（元语言）
✗ 决策: 热情地问候（缺少"行动【】"格式）

【执行层命令格式（JSON）】
{
    "type": "reply",
    "content": "行动【...】",
    "context": "..."
}

┌──────────────────────────────────────────────────────────────┐
│ 🚀 启动方式                                                   │
└──────────────────────────────────────────────────────────────┘

方式1：批处理（推荐）
    启动两层架构.bat

方式2：命令行
    python thinking_layer.py

注意：思考层会自动启动执行层

┌──────────────────────────────────────────────────────────────┐
│ 💬 可用命令                                                   │
└──────────────────────────────────────────────────────────────┘

对话命令：
    直接输入消息    - 与AI对话

系统命令：
    /status 或 /s  - 查看系统状态
    /history 或 /h - 查看执行历史
    /quit 或 /q    - 退出系统

┌──────────────────────────────────────────────────────────────┐
│ 📝 使用示例                                                   │
└──────────────────────────────────────────────────────────────┘

【基本对话】
你 > 你好

💭 [思考层思考中...]
决策: 行动【热情地问候用户并询问需求】

[执行层执行...]

🤖 FakeMan [✓] > 你好！很高兴见到你，有什么可以帮助你的吗？

💡 [耗时: 15.2秒 | 目的: 4 | 手段: 8]

【查看执行历史】
你 > /history

【执行层历史记录】（最近的命令和结果）

1. 命令类型: reply
   指令: 行动【热情地问候用户并询问需求】
   结果: 你好！很高兴见到你...

2. 命令类型: reply
   指令: 行动【分享Python知识】
   结果: Python有一个有趣的特性...

【查看系统状态】
你 > /status

系统状态：
  周期数: 3
  目的数: 4
  手段数: 8
  执行历史: 2 条

┌──────────────────────────────────────────────────────────────┐
│ 🔄 完整流程                                                   │
└──────────────────────────────────────────────────────────────┘

1. 用户输入
   ↓
2. 思考层分析
   - 分析情境
   - 评估目的和手段
   - 做出决策
   ↓
3. 生成命令
   决策: 行动【...】
   ↓
4. 发送到执行层（JSON）
   ↓
5. 执行层处理
   - 接收命令
   - 调用LLM
   - 生成具体内容
   ↓
6. 返回结果（JSON）
   ↓
7. 思考层接收
   - 记录历史
   - 显示结果
   ↓
8. 用户看到最终回复

┌──────────────────────────────────────────────────────────────┐
│ 📊 性能数据                                                   │
└──────────────────────────────────────────────────────────────┘

API调用次数：  2次（思考1次 + 执行1次）
平均响应时间：  15-20秒
进程通信延迟：  <100ms
内存占用：     ~200MB（两个进程）

┌──────────────────────────────────────────────────────────────┐
│ ✅ 核心优势                                                   │
└──────────────────────────────────────────────────────────────┘

1. 职责分离   - 思考和执行完全分离
2. 避免混淆   - 不会输出策略描述
3. 可追溯性   - 每个命令都有记录
4. 易于调试   - 每层独立日志

┌──────────────────────────────────────────────────────────────┐
│ 📁 关键文件                                                   │
└──────────────────────────────────────────────────────────────┘

thinking_layer.py      - 思考层实现（252行）
execution_layer.py     - 执行层实现（268行）
启动两层架构.bat       - 启动脚本
两层架构说明.md        - 完整文档
两层架构-完成.md       - 实现总结

┌──────────────────────────────────────────────────────────────┐
│ 🐛 常见问题                                                   │
└──────────────────────────────────────────────────────────────┘

Q: 执行层启动失败？
A: 检查 execution_layer.py 是否存在，Python环境是否正确

Q: 命令格式错误？
A: 确保使用 "行动【...】" 格式

Q: 进程通信失败？
A: 检查JSON格式、编码、管道是否阻塞

┌──────────────────────────────────────────────────────────────┐
│ 📚 文档位置                                                   │
└──────────────────────────────────────────────────────────────┘

详细文档：    两层架构说明.md
实现总结：    两层架构-完成.md
快速参考：    两层架构快速参考.txt（本文档）

┌──────────────────────────────────────────────────────────────┐
│ 🎯 使用建议                                                   │
└──────────────────────────────────────────────────────────────┘

✓ 适合需要精确控制的场景
✓ 适合需要审计的应用
✓ 适合复杂的多步骤任务
✓ 适合需要清晰分离思考和执行的情况

═══════════════════════════════════════════════════════════════

立即体验：
    python thinking_layer.py

或：
    启动两层架构.bat

═══════════════════════════════════════════════════════════════

