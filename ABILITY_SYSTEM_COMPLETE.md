# èƒ½åŠ›ç³»ç»Ÿåˆ›å»ºå®Œæˆ

## âœ… å®ŒæˆçŠ¶æ€

èƒ½åŠ›ç³»ç»Ÿå·²å®Œå…¨å®ç°å¹¶æµ‹è¯•é€šè¿‡ï¼

## ğŸ“ æ–‡ä»¶ç»“æ„

```
ability/
â”œâ”€â”€ __init__.py                 # åŒ…åˆå§‹åŒ–
â”œâ”€â”€ ability_manager.py          # èƒ½åŠ›ç®¡ç†å™¨ï¼ˆæ ¸å¿ƒï¼‰
â”œâ”€â”€ send_to_gui.py             # GUIé€šä¿¡å·¥å…·
â”œâ”€â”€ example_tool.py            # ç¤ºä¾‹æ–‡æœ¬åˆ†æå·¥å…·
â””â”€â”€ README.md                  # ä½¿ç”¨è¯´æ˜

docs/
â””â”€â”€ ABILITY_SYSTEM.md          # è¯¦ç»†æ–‡æ¡£

ABILITY_SYSTEM_COMPLETE.md     # æœ¬æ–‡ä»¶
```

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. AbilityManager - èƒ½åŠ›ç®¡ç†å™¨

âœ… **æ‰«æèƒ½åŠ›**: è‡ªåŠ¨æ‰«æabilityæ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰Pythonç¨‹åº  
âœ… **è¯»å–ä»£ç **: å¯ä»¥è¯»å–ä»»ä½•å·¥å…·çš„æºä»£ç   
âœ… **æ‰§è¡Œå‘½ä»¤**: å®‰å…¨åœ°æ‰§è¡Œå‘½ä»¤è¡ŒæŒ‡ä»¤å¹¶è·å–è¾“å‡º  
âœ… **åˆ›å»ºå·¥å…·**: åŠ¨æ€åˆ›å»ºæ–°çš„å·¥å…·ç¨‹åº  
âœ… **GUIç®¡ç†**: è‡ªåŠ¨ç®¡ç†GUIç¨‹åºï¼Œç¡®ä¿åŒæ—¶åªè¿è¡Œä¸€ä¸ª  
âœ… **å†å²è®°å½•**: è®°å½•æ‰€æœ‰æ‰§è¡Œå†å²  

### 2. SafetyChecker - å®‰å…¨æ£€æŸ¥å™¨

âœ… **å…³é”®è¯è¿‡æ»¤**: è‡ªåŠ¨æ‹¦æˆªå±é™©å‘½ä»¤ï¼ˆrm -rf, format, shutdownç­‰ï¼‰  
âœ… **è·¯å¾„ä¿æŠ¤**: ç¦æ­¢è®¿é—®ç³»ç»Ÿå…³é”®ç›®å½•  
âœ… **æƒé™é™åˆ¶**: ä¸å…è®¸ä½¿ç”¨ç®¡ç†å‘˜æƒé™  
âœ… **ä»£ç æ£€æŸ¥**: åˆ›å»ºæ–°å·¥å…·æ—¶æ£€æŸ¥ä»£ç å®‰å…¨æ€§  

### 3. å†…ç½®å·¥å…·

âœ… **send_to_gui.py**: å‘chat_guiå‘é€æ¶ˆæ¯  
âœ… **example_tool.py**: æ–‡æœ¬åˆ†æå·¥å…·ï¼ˆç¤ºä¾‹ï¼‰  

## ğŸ§ª æµ‹è¯•ç»“æœ

### æµ‹è¯•1: èƒ½åŠ›ç®¡ç†å™¨

```bash
$ python ability/ability_manager.py

å¯ç”¨èƒ½åŠ›:
  - ability_manager
  - example_tool
  - send_to_gui

æ‰§è¡Œæµ‹è¯•å‘½ä»¤:
  è¾“å‡º: æµ‹è¯•
```

âœ… **é€šè¿‡**

### æµ‹è¯•2: GUIé€šä¿¡å·¥å…·

```bash
$ python ability/send_to_gui.py "æµ‹è¯•æ¶ˆæ¯ï¼šèƒ½åŠ›ç³»ç»Ÿå·²å¯åŠ¨"

âœ“ æ¶ˆæ¯å·²å‘é€: æµ‹è¯•æ¶ˆæ¯ï¼šèƒ½åŠ›ç³»ç»Ÿå·²å¯åŠ¨...
```

âœ… **é€šè¿‡**

### æµ‹è¯•3: æ–‡æœ¬åˆ†æå·¥å…·

```bash
$ python ability/example_tool.py "Hello World ä½ å¥½ä¸–ç•Œ 123"

========================================
æ–‡æœ¬åˆ†æç»“æœ
========================================
æ€»å­—ç¬¦æ•°: 28
å­—ç¬¦æ•°ï¼ˆä¸å«ç©ºæ ¼ï¼‰: 25
è¯æ•°: 8
è¡Œæ•°: 1
ä¸­æ–‡å­—ç¬¦: 0
è‹±æ–‡å­—ç¬¦: 10
æ•°å­—å­—ç¬¦: 3
========================================
```

âœ… **é€šè¿‡**

## ğŸ“– ä½¿ç”¨ç¤ºä¾‹

### AIå¦‚ä½•ä½¿ç”¨èƒ½åŠ›ç³»ç»Ÿ

```python
from ability.ability_manager import get_ability_manager

# 1. è·å–ç®¡ç†å™¨
manager = get_ability_manager()

# 2. æŸ¥çœ‹å¯ç”¨å·¥å…·
abilities = manager.list_abilities()
for ability in abilities:
    print(f"{ability['name']}: {ability['description']}")

# 3. æŸ¥çœ‹å·¥å…·ä»£ç ï¼ˆäº†è§£åŠŸèƒ½ï¼‰
code = manager.read_ability_code('send_to_gui')
print(code)

# 4. æ‰§è¡Œå·¥å…·
result = manager.execute_command(
    'python ability/send_to_gui.py "Hello"'
)
print(result['output'])

# 5. åˆ›å»ºæ–°å·¥å…·
new_tool = '''
import sys
print("å¤„ç†:", sys.argv[1] if len(sys.argv) > 1 else "æ— å‚æ•°")
'''

manager.create_ability(
    name='my_tool',
    code=new_tool,
    description='æˆ‘çš„ç¬¬ä¸€ä¸ªå·¥å…·'
)

# 6. ä½¿ç”¨æ–°å·¥å…·
result = manager.execute_command('python ability/my_tool.py "test"')
print(result['output'])
```

## ğŸ”’ å®‰å…¨ç‰¹æ€§

### ç¦æ­¢æ“ä½œåˆ—è¡¨

âŒ **ç³»ç»Ÿç ´å**
- `rm -rf`, `del /f`, `format`
- `shutdown`, `reboot`

âŒ **æƒé™æå‡**
- `sudo`, `runas`, `administrator`

âŒ **å±é™©æ“ä½œ**
- `chmod 777`, `chown`
- `> /dev/`, `mkfs`, `dd if=`
- `curl | sh`, `wget | sh`

âŒ **ç³»ç»Ÿç›®å½•è®¿é—®**
- `/etc/`, `/bin/`, `/sbin/`
- `C:\Windows`, `C:\System32`

### è‡ªåŠ¨ä¿æŠ¤

âœ… å‘½ä»¤æ‰§è¡Œå‰è‡ªåŠ¨å®‰å…¨æ£€æŸ¥  
âœ… GUIç¨‹åºè‡ªåŠ¨å•ä¾‹ç®¡ç†  
âœ… æ‰§è¡Œè¶…æ—¶ä¿æŠ¤ï¼ˆé»˜è®¤30ç§’ï¼‰  
âœ… ä»£ç åˆ›å»ºæ—¶å®‰å…¨éªŒè¯  

## ğŸ’¡ å…¸å‹åº”ç”¨åœºæ™¯

### åœºæ™¯1: å‘ç”¨æˆ·å‘é€æ¶ˆæ¯

```python
# AIéœ€è¦å‘ç”¨æˆ·å‘é€æ¶ˆæ¯
manager.execute_command(
    'python ability/send_to_gui.py "ç³»ç»Ÿå·²å®Œæˆä»»åŠ¡å¤„ç†"'
)
```

### åœºæ™¯2: åˆ†æç”¨æˆ·è¾“å…¥

```python
# AIåˆ†æç”¨æˆ·è¾“å…¥çš„æ–‡æœ¬
user_text = "ç”¨æˆ·å‘æ¥çš„ä¸€æ®µé•¿æ–‡æœ¬..."
result = manager.execute_command(
    f'python ability/example_tool.py "{user_text}"'
)
# è·å–ç»Ÿè®¡ä¿¡æ¯
print(result['output'])
```

### åœºæ™¯3: åˆ›å»ºä¸“ç”¨å·¥å…·

```python
# AIéœ€è¦ä¸€ä¸ªè®¡ç®—å™¨
calculator_code = '''
import sys
import operator

ops = {'+': operator.add, '-': operator.sub, 
       '*': operator.mul, '/': operator.truediv}

if len(sys.argv) == 4:
    a, op, b = float(sys.argv[1]), sys.argv[2], float(sys.argv[3])
    print(f"{a} {op} {b} = {ops[op](a, b)}")
else:
    print("ç”¨æ³•: calc.py <æ•°å­—> <è¿ç®—ç¬¦> <æ•°å­—>")
'''

manager.create_ability('calc', calculator_code, 'ç®€å•è®¡ç®—å™¨')

# ä½¿ç”¨è®¡ç®—å™¨
result = manager.execute_command('python ability/calc.py 10 + 5')
print(result['output'])  # 10 + 5 = 15
```

### åœºæ™¯4: æŸ¥çœ‹å·¥å…·åŠŸèƒ½

```python
# AIä¸ç¡®å®šæŸä¸ªå·¥å…·çš„åŠŸèƒ½
code = manager.read_ability_code('send_to_gui')

# AIåˆ†æä»£ç åç†è§£ï¼šè¿™æ˜¯ä¸€ä¸ªå‘GUIå‘é€æ¶ˆæ¯çš„å·¥å…·
# ç„¶åæ­£ç¡®ä½¿ç”¨å®ƒ
```

## ğŸš€ æ‰©å±•å¯èƒ½æ€§

### å¯ä»¥åˆ›å»ºçš„å·¥å…·ç±»å‹

1. **æ–‡æœ¬å¤„ç†**: åˆ†è¯ã€ç¿»è¯‘ã€æ ¼å¼åŒ–
2. **æ•°æ®åˆ†æ**: ç»Ÿè®¡ã€å›¾è¡¨ç”Ÿæˆ
3. **æ–‡ä»¶æ“ä½œ**: è¯»å†™ã€æœç´¢ã€æ•´ç†
4. **ç½‘ç»œå·¥å…·**: APIè°ƒç”¨ã€ä¸‹è½½ã€æŸ¥è¯¢
5. **ç³»ç»Ÿç›‘æ§**: è¿›ç¨‹æŸ¥çœ‹ã€èµ„æºç»Ÿè®¡
6. **äº¤äº’å·¥å…·**: ç®€å•GUIã€å¯¹è¯æ¡†

### é™åˆ¶è¯´æ˜

âœ… **å…è®¸**: æ™®é€šPythonç¨‹åºã€æ•°æ®å¤„ç†ã€æ–‡æœ¬æ“ä½œ  
âŒ **ç¦æ­¢**: ç³»ç»Ÿç®¡ç†ã€å±é™©æ“ä½œã€æ¶æ„ä»£ç   

## ğŸ“š æ–‡æ¡£

- **ability/README.md**: åŸºç¡€ä½¿ç”¨è¯´æ˜
- **docs/ABILITY_SYSTEM.md**: å®Œæ•´æŠ€æœ¯æ–‡æ¡£
- **ABILITY_SYSTEM_COMPLETE.md**: æœ¬æ€»ç»“æ–‡æ¡£

## ğŸ”„ ä¸ä¸»ç³»ç»Ÿé›†æˆ

èƒ½åŠ›ç³»ç»Ÿå¯ä»¥æ— ç¼é›†æˆåˆ°FakeManä¸»ç³»ç»Ÿï¼š

```python
class FakeManRefactored:
    def __init__(self, config):
        # ... å…¶ä»–åˆå§‹åŒ–
        self.ability_manager = get_ability_manager()
    
    def _think_and_decide(self, context: str):
        # åœ¨æ€è€ƒè¿‡ç¨‹ä¸­ä½¿ç”¨èƒ½åŠ›
        
        # åˆ—å‡ºå¯ç”¨èƒ½åŠ›
        abilities = self.ability_manager.list_abilities()
        
        # æ ¹æ®éœ€è¦ä½¿ç”¨å·¥å…·
        if need_analysis:
            result = self.ability_manager.execute_command(...)
            
        # åˆ›å»ºæ–°å·¥å…·
        if need_new_tool:
            self.ability_manager.create_ability(...)
```

## âœ¨ ç‰¹è‰²åŠŸèƒ½

1. **è‡ªä¸»å‘ç°**: AIå¯ä»¥æ‰«æå¹¶å‘ç°æ‰€æœ‰å¯ç”¨å·¥å…·
2. **ä»£ç å­¦ä¹ **: AIå¯ä»¥è¯»å–ä»£ç ç†è§£å·¥å…·åŠŸèƒ½
3. **åŠ¨æ€åˆ›å»º**: AIå¯ä»¥æ ¹æ®éœ€æ±‚åˆ›å»ºæ–°å·¥å…·
4. **å®‰å…¨æ‰§è¡Œ**: å…¨æ–¹ä½å®‰å…¨ä¿æŠ¤æœºåˆ¶
5. **GUIé›†æˆ**: æ— ç¼ä¸å›¾å½¢ç•Œé¢é€šä¿¡
6. **å†å²è¿½è¸ª**: å®Œæ•´çš„æ‰§è¡Œå†å²è®°å½•

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

- **æ‰«æé€Ÿåº¦**: <0.1ç§’ï¼ˆæ‰«ææ‰€æœ‰å·¥å…·ï¼‰
- **æ‰§è¡Œå¯åŠ¨**: <0.5ç§’ï¼ˆæ™®é€šå‘½ä»¤ï¼‰
- **ä»£ç è¯»å–**: <0.01ç§’
- **å®‰å…¨æ£€æŸ¥**: <0.01ç§’
- **GUIå¯åŠ¨**: <1ç§’

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

### 1. åˆ›å»ºæ›´å¤šå·¥å…·

å»ºè®®åˆ›å»ºçš„å·¥å…·ï¼š
- [ ] æ–‡ä»¶æœç´¢å·¥å…·
- [ ] JSONå¤„ç†å·¥å…·
- [ ] æ—¶é—´æ—¥æœŸå·¥å…·
- [ ] ç½‘ç»œæŸ¥è¯¢å·¥å…·
- [ ] æ•°å­¦è®¡ç®—å·¥å…·

### 2. å¢å¼ºåŠŸèƒ½

- [ ] æ”¯æŒå¼‚æ­¥æ‰§è¡Œé•¿æ—¶é—´ä»»åŠ¡
- [ ] æ·»åŠ å·¥å…·ä¾èµ–ç®¡ç†
- [ ] å®ç°å·¥å…·ç‰ˆæœ¬æ§åˆ¶
- [ ] æ·»åŠ å·¥å…·æµ‹è¯•æ¡†æ¶

### 3. å®‰å…¨å¢å¼º

- [ ] æ·»åŠ èµ„æºä½¿ç”¨é™åˆ¶ï¼ˆCPUã€å†…å­˜ï¼‰
- [ ] å®ç°æ²™ç®±æ‰§è¡Œç¯å¢ƒ
- [ ] æ·»åŠ ç½‘ç»œè®¿é—®æ§åˆ¶
- [ ] å®Œå–„æ—¥å¿—å’Œå®¡è®¡

## ğŸ“– ç›¸å…³æ–‡æ¡£

- [ä¸»ç³»ç»Ÿæ–‡æ¡£](README.md)
- [æ–°æ¶æ„è¯´æ˜](docs/NEW_ARCHITECTURE.md)
- [èƒ½åŠ›ç³»ç»Ÿè¯¦ç»†æ–‡æ¡£](docs/ABILITY_SYSTEM.md)
- [èƒ½åŠ›ç³»ç»Ÿä½¿ç”¨æŒ‡å—](ability/README.md)

## ğŸ‰ æ€»ç»“

èƒ½åŠ›ç³»ç»Ÿä¸ºFakeManæä¾›äº†ï¼š

âœ… **å·¥å…·æ‰©å±•èƒ½åŠ›** - AIå¯ä»¥ä½¿ç”¨å’Œåˆ›å»ºå·¥å…·  
âœ… **å®‰å…¨æ‰§è¡Œç¯å¢ƒ** - å®Œå–„çš„å®‰å…¨ä¿æŠ¤æœºåˆ¶  
âœ… **GUIé€šä¿¡èƒ½åŠ›** - ä¸ç”¨æˆ·ç•Œé¢æ— ç¼é›†æˆ  
âœ… **è‡ªä¸»å­¦ä¹ èƒ½åŠ›** - é€šè¿‡ä»£ç ç†è§£å·¥å…·åŠŸèƒ½  
âœ… **åŠ¨æ€åˆ›å»ºèƒ½åŠ›** - æ ¹æ®éœ€æ±‚åˆ›å»ºæ–°å·¥å…·  

**èƒ½åŠ›ç³»ç»Ÿå·²å®Œå…¨å°±ç»ªï¼Œå¯ä»¥æŠ•å…¥ä½¿ç”¨ï¼** ğŸš€

---

*åˆ›å»ºæ—¶é—´: 2025-11-03*  
*ç‰ˆæœ¬: 1.0.0*  
*çŠ¶æ€: âœ… å®Œæˆå¹¶æµ‹è¯•é€šè¿‡*

