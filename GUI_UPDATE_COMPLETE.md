# GUIå’ŒMain.pyæ›´æ–°å®Œæˆ

## âœ… å®Œæˆçš„ä¿®æ”¹

### 1. Chat GUI é‡æ„

#### åŸæ¥çš„è®¾è®¡
- å·¦å³åŒæ å¸ƒå±€
- å·¦ä¾§æ˜¾ç¤ºAIè¾“å‡ºï¼Œå³ä¾§æ˜¾ç¤ºç”¨æˆ·è¾“å…¥
- æ¶ˆæ¯åˆ†å¼€æ˜¾ç¤º

#### æ–°è®¾è®¡
- âœ… **å•ä¸€å¯¹è¯æ¡†**: æ‰€æœ‰æ¶ˆæ¯æŒ‰æ—¶é—´é¡ºåºåœ¨ä¸€ä¸ªå¯¹è¯æ¡†ä¸­æ˜¾ç¤º
- âœ… **æ•°æ®é©±åŠ¨**: ä» `chat_history.json` è¯»å–å¹¶æ˜¾ç¤ºæ‰€æœ‰å†å²è®°å½•
- âœ… **è‡ªåŠ¨ä¿å­˜**: æ¯æ¡æ¶ˆæ¯è‡ªåŠ¨ä¿å­˜åˆ°æ–‡ä»¶
- âœ… **æŒä¹…åŒ–**: å…³é—­é‡å¼€åå†å²è®°å½•ä¾ç„¶å­˜åœ¨
- âœ… **æ¸…ç©ºåŠŸèƒ½**: æ–°å¢"æ¸…ç©ºå†å²"æŒ‰é’®

#### æ¶ˆæ¯æ ¼å¼
```
[2025-11-03 19:30:15]
ğŸ‘¤ ä½ : ä½ å¥½

[2025-11-03 19:30:18]
ğŸ¤– AI: ä½ å¥½ï¼æˆ‘æ˜¯FakeMan...
   ğŸ’­ æ€è€ƒ: ç”¨æˆ·æ‰“æ‹›å‘¼ï¼Œåº”è¯¥å‹å¥½å›åº”
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

#### æ•°æ®æ–‡ä»¶ä½ç½®
- **èŠå¤©å†å²**: `data/communication/chat_history.json`
- **ç”¨æˆ·è¾“å…¥**: `data/communication/user_input.json`
- **AIè¾“å‡º**: `data/communication/ai_output.json`

### 2. Main.py æ”¹ä¸ºæŒç»­è¿è¡Œ

#### åŸæ¥çš„è¡Œä¸º
```python
for i in range(5):  # åªè¿è¡Œ5ä¸ªå‘¨æœŸå°±åœæ­¢
    ...
```

#### æ–°è¡Œä¸º
```python
while True:  # æŒç»­è¿è¡Œ
    # ç›‘å¬ç”¨æˆ·è¾“å…¥
    # æ¯30ç§’å†…éƒ¨æ€è€ƒä¸€æ¬¡
    # å“åº”ç”¨æˆ·æ¶ˆæ¯
```

#### ç‰¹æ€§
- âœ… **æŒç»­ç›‘å¬**: å®æ—¶ç›‘å¬é€šä¿¡æ–‡ä»¶
- âœ… **è‡ªåŠ¨å“åº”**: æ”¶åˆ°ç”¨æˆ·è¾“å…¥ç«‹å³å¤„ç†
- âœ… **å®šæœŸæ€è€ƒ**: æ¯30ç§’è‡ªåŠ¨æ€è€ƒä¸€æ¬¡
- âœ… **å®‰å…¨é€€å‡º**: Ctrl+C å®‰å…¨ä¿å­˜å¹¶é€€å‡º
- âœ… **çŠ¶æ€æ˜¾ç¤º**: æ˜¾ç¤ºå‘¨æœŸæ•°ã€ç›®çš„ã€æ‰‹æ®µç­‰

### 3. æ–°å¢èŠå¤©å†å²è¯»å–å·¥å…·

#### å·¥å…·ä½ç½®
`ability/read_chat_history.py`

#### åŠŸèƒ½
AIå¯ä»¥è¯»å–èŠå¤©å†å²ï¼Œäº†è§£ä¹‹å‰çš„å¯¹è¯å†…å®¹ã€‚

#### ç”¨æ³•

**åŸºç¡€ç”¨æ³•**:
```bash
# æ˜¾ç¤ºæœ€è¿‘10æ¡æ¶ˆæ¯
python ability/read_chat_history.py

# æ˜¾ç¤ºæ‰€æœ‰æ¶ˆæ¯
python ability/read_chat_history.py all

# æ˜¾ç¤ºæœ€è¿‘20æ¡
python ability/read_chat_history.py 20
```

**è¿‡æ»¤é€‰é¡¹**:
```bash
# åªçœ‹ç”¨æˆ·æ¶ˆæ¯
python ability/read_chat_history.py user

# åªçœ‹AIæ¶ˆæ¯
python ability/read_chat_history.py ai
```

**JSONè¾“å‡º**:
```bash
# ä»¥JSONæ ¼å¼è¾“å‡ºï¼ˆæ–¹ä¾¿ç¨‹åºå¤„ç†ï¼‰
python ability/read_chat_history.py json
```

#### è¾“å‡ºç¤ºä¾‹

```
================================================================================
èŠå¤©å†å²è®°å½• (å…± 15 æ¡æ¶ˆæ¯)
ç”¨æˆ·: 8 | AI: 6 | ç³»ç»Ÿ: 1
================================================================================

æ˜¾ç¤ºæœ€è¿‘ 10 æ¡ (å…± 15 æ¡)
================================================================================

[6] [2025-11-03 19:30:15] ğŸ‘¤ ä½ : ä½ å¥½
--------------------------------------------------------------------------------
[7] [2025-11-03 19:30:18] ğŸ¤– AI: ä½ å¥½ï¼æˆ‘æ˜¯FakeMan...
   ğŸ’­ æ€è€ƒ: ç”¨æˆ·æ‰“æ‹›å‘¼ï¼Œåº”è¯¥å‹å¥½å›åº”
--------------------------------------------------------------------------------
...
```

## ğŸ¯ ä½¿ç”¨æ–¹å¼

### å¯åŠ¨é¡ºåº

**æ–¹å¼1: ä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èæ–°æ‰‹ï¼‰**
```bash
python run_fakeman.py
```
è¿™ä¼šå¯åŠ¨äº¤äº’å¼ç•Œé¢ï¼Œå¯ä»¥åœ¨å‘½ä»¤è¡Œç›´æ¥å¯¹è¯ã€‚

**æ–¹å¼2: ä½¿ç”¨GUIç•Œé¢ï¼ˆæ¨èï¼‰**
```bash
# ç»ˆç«¯1: å¯åŠ¨ä¸»ç³»ç»Ÿï¼ˆæŒç»­è¿è¡Œï¼‰
python main.py

# ç»ˆç«¯2: å¯åŠ¨GUI
python chat_gui.py
```

**æ–¹å¼3: ä½¿ç”¨æ‰¹å¤„ç†è„šæœ¬**
```bash
# Windows
start_gui.bat

# Linux/Mac
./start_gui.sh
```

### å…¸å‹å·¥ä½œæµç¨‹

1. **å¯åŠ¨ç³»ç»Ÿ**
```bash
python main.py
```
è¾“å‡ºï¼š
```
FakeMan é‡æ„ç‰ˆç³»ç»Ÿå·²å¯åŠ¨
============================================================
æ¨¡å¼: æŒç»­æ€è€ƒï¼ˆç›‘å¬é€šä¿¡æ–‡ä»¶ï¼‰
æŒ‰ Ctrl+C å¯ä»¥å®‰å…¨é€€å‡º
============================================================
```

2. **å¯åŠ¨GUI**
```bash
python chat_gui.py
```

3. **å¼€å§‹å¯¹è¯**
   - åœ¨GUIä¸­è¾“å…¥æ¶ˆæ¯
   - ç‚¹å‡»"å‘é€"æˆ–æŒ‰ Ctrl+Enter
   - AIè‡ªåŠ¨å›å¤

4. **AIè¯»å–å†å²**
   - AIå¯ä»¥ä½¿ç”¨ `read_chat_history.py` æŸ¥çœ‹ä¹‹å‰çš„å¯¹è¯
   - äº†è§£ä¸Šä¸‹æ–‡ï¼Œåšå‡ºæ›´å¥½çš„å›åº”

5. **åœæ­¢ç³»ç»Ÿ**
   - GUI: ç›´æ¥å…³é—­çª—å£
   - Main.py: æŒ‰ Ctrl+C

## ğŸ“Š æ•°æ®ç»“æ„

### chat_history.json æ ¼å¼

```json
{
  "messages": [
    {
      "type": "user",
      "content": "ä½ å¥½",
      "timestamp": 1699000000.123
    },
    {
      "type": "ai",
      "content": "ä½ å¥½ï¼æˆ‘æ˜¯FakeMan...",
      "timestamp": 1699000003.456,
      "action_type": "response",
      "thought_summary": "ç”¨æˆ·æ‰“æ‹›å‘¼ï¼Œåº”è¯¥å‹å¥½å›åº”"
    },
    {
      "type": "system",
      "content": "ç³»ç»Ÿæç¤ºä¿¡æ¯",
      "timestamp": 1699000010.789
    }
  ],
  "last_updated": 1699000010.789
}
```

### æ¶ˆæ¯ç±»å‹

| ç±»å‹ | è¯´æ˜ | å­—æ®µ |
|------|------|------|
| user | ç”¨æˆ·æ¶ˆæ¯ | type, content, timestamp |
| ai | AIå›å¤ | type, content, timestamp, action_type, thought_summary |
| system | ç³»ç»Ÿæ¶ˆæ¯ | type, content, timestamp |

## ğŸ”§ AIä½¿ç”¨ç¤ºä¾‹

### åœ¨æ€è€ƒè¿‡ç¨‹ä¸­è¯»å–å†å²

```python
from ability.ability_manager import get_ability_manager

manager = get_ability_manager()

# è¯»å–æœ€è¿‘10æ¡æ¶ˆæ¯
result = manager.execute_command('python ability/read_chat_history.py 10')
history = result['output']

# åŸºäºå†å²åšå†³ç­–
if 'ä½ å¥½' in history:
    # ç”¨æˆ·ä¹‹å‰æ‰“è¿‡æ‹›å‘¼äº†
    response = "æˆ‘ä»¬ç»§ç»­ä¹‹å‰çš„è¯é¢˜..."
else:
    response = "ä½ å¥½ï¼å¾ˆé«˜å…´è®¤è¯†ä½ ..."
```

### æŸ¥çœ‹ç”¨æˆ·æ‰€æœ‰é—®é¢˜

```python
# åªçœ‹ç”¨æˆ·æ¶ˆæ¯
result = manager.execute_command('python ability/read_chat_history.py user')
user_messages = result['output']

# åˆ†æç”¨æˆ·å…³æ³¨ç‚¹
if 'åŠŸèƒ½' in user_messages:
    # ç”¨æˆ·å…³å¿ƒåŠŸèƒ½
    ...
```

### ä»¥JSONæ ¼å¼å¤„ç†

```python
import json

# è·å–JSONæ ¼å¼çš„å†å²
result = manager.execute_command('python ability/read_chat_history.py json')
messages = json.loads(result['output'])

# ç»Ÿè®¡ç”¨æˆ·é—®é¢˜æ•°é‡
user_questions = [m for m in messages if m['type'] == 'user']
print(f"ç”¨æˆ·é—®äº† {len(user_questions)} ä¸ªé—®é¢˜")
```

## ğŸ¨ GUIç‰¹æ€§

### 1. æ—¶é—´æˆ³æ˜¾ç¤º
æ¯æ¡æ¶ˆæ¯éƒ½æ˜¾ç¤ºç²¾ç¡®çš„æ—¶é—´ï¼ˆå¹´-æœˆ-æ—¥ æ—¶:åˆ†:ç§’ï¼‰

### 2. æ¶ˆæ¯ç±»å‹æ ‡è¯†
- ğŸ‘¤ ç”¨æˆ·æ¶ˆæ¯
- ğŸ¤– AIå›å¤
- ğŸ¤– AI (ä¸»åŠ¨): AIä¸»åŠ¨å‘è¨€
- â„¹ï¸ ç³»ç»Ÿæ¶ˆæ¯

### 3. æ€è€ƒæ‘˜è¦
AIå›å¤ä¼šæ˜¾ç¤ºæ€è€ƒè¿‡ç¨‹æ‘˜è¦ï¼ˆå¦‚æœæœ‰ï¼‰

### 4. æ¶ˆæ¯è®¡æ•°
åº•éƒ¨çŠ¶æ€æ å®æ—¶æ˜¾ç¤ºæ¶ˆæ¯æ€»æ•°

### 5. å†å²æŒä¹…åŒ–
- è‡ªåŠ¨ä¿å­˜åˆ°æ–‡ä»¶
- é‡å¯åæ¢å¤å†å²
- æ”¯æŒæ¸…ç©ºå†å²

## ğŸ”„ ä¸æ—§ç‰ˆæœ¬çš„åŒºåˆ«

| ç‰¹æ€§ | æ—§ç‰ˆæœ¬ | æ–°ç‰ˆæœ¬ |
|------|--------|--------|
| å¸ƒå±€ | å·¦å³åŒæ  | å•ä¸€å¯¹è¯æ¡† |
| å†å²è®°å½• | ä¸ä¿å­˜ | è‡ªåŠ¨ä¿å­˜ |
| æŒä¹…åŒ– | å…³é—­å³ä¸¢å¤± | æ°¸ä¹…ä¿å­˜ |
| AIå¯è¯» | âŒ ä¸å¯è¯» | âœ… å¯è¯»å– |
| Main.py | 5å‘¨æœŸåœæ­¢ | æŒç»­è¿è¡Œ |
| æ¸…ç©ºåŠŸèƒ½ | âŒ æ—  | âœ… æœ‰ |

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **Main.pyå¿…é¡»æŒç»­è¿è¡Œ**: GUIåªæ˜¯ç•Œé¢ï¼Œé€»è¾‘åœ¨main.pyä¸­
2. **å†å²æ–‡ä»¶ä½ç½®**: `data/communication/chat_history.json`
3. **ä¸è¦æ‰‹åŠ¨ç¼–è¾‘**: å†å²æ–‡ä»¶ç”±ç³»ç»Ÿè‡ªåŠ¨ç®¡ç†
4. **æ¸…ç©ºå†å²**: ä½¿ç”¨GUIçš„"æ¸…ç©ºå†å²"æŒ‰é’®
5. **AIè¯»å–**: AIå¯ä»¥éšæ—¶è¯»å–å†å²ï¼Œäº†è§£ä¸Šä¸‹æ–‡

## ğŸš€ å¿«é€Ÿæµ‹è¯•

```bash
# 1. å¯åŠ¨ä¸»ç³»ç»Ÿ
python main.py

# 2. æ–°ç»ˆç«¯ï¼Œå¯åŠ¨GUI
python chat_gui.py

# 3. åœ¨GUIä¸­è¾“å…¥"ä½ å¥½"

# 4. æ–°ç»ˆç«¯ï¼ŒæŸ¥çœ‹å†å²
python ability/read_chat_history.py

# 5. åº”è¯¥èƒ½çœ‹åˆ°ä½ çš„æ¶ˆæ¯å’ŒAIçš„å›å¤
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [èƒ½åŠ›ç³»ç»Ÿæ–‡æ¡£](docs/ABILITY_SYSTEM.md)
- [å¿«é€Ÿå¼€å§‹](START_HERE.md)
- [ä¸»README](README.md)

---

**æ‰€æœ‰ä¿®æ”¹å·²å®Œæˆå¹¶æµ‹è¯•ï¼** âœ…

*æ›´æ–°æ—¶é—´: 2025-11-03*

